var planningInit=false;function showPlanning(){if(!planningInit){var a=GoogleAuth.currentUser.get();var c=a.getAuthResponse().id_token;var b=new XMLHttpRequest();b.open("GET","/user/v1/promises/id/"+c+"/b/"+gBotBand+"/n/"+gBotNumber);b.setRequestHeader("Content-Type","application/x-www-form-urlencoded");b.onload=function(){renderPlanning((b.status==200)?b.responseText:"[]")};b.send()}else{navbarActive("planning")}}var events;var gCal;function renderPlanning(c){var a=JSON.parse(c);var b=0;for(i in a){if(a[i].Stacked==0){for(y=i;y>=Math.max(0,i-b);y--){a[y].level=b}b=0}}events=[];for(i in a){events.push({level:a[i].level,startDate:new Date(a[i].TripStart.substr(0,10)),endDate:new Date(a[i].TripEnd.substr(0,10))})}if(gCal==null){gCal=new Calendar("#calendar",{customDataSourceRenderer:dsRender,style:"custom"})}gCal.setDataSource(events);navbarActive("planning");planningInit=true}function dsRender(c,a,b){var d=["grey","dimgrey","black"];$(c).css("background-color",d[b[0].level]);$(c).css("color","white");$(c).css("border-radius","0px")};